import { h } from 'preact'
import { Image } from "site/sections/BannerPhone.tsx";
import { useState, useEffect } from 'preact/hooks'

export interface Props {
    images: Image[]
    phoneImage?: string
    construction?: boolean
}

const PhoneSlider = ({ images, phoneImage, construction }: Props) => {
    const [currentIndex, setCurrentIndex] = useState(0)
    const interval = 3000
    const transitionDuration = 500

    useEffect(() => {
        if (images.length > 0) {
            const timer = setInterval(() => {
                setCurrentIndex((prevIndex) => (prevIndex + 1) % images.length)
            }, interval)
            return () => clearInterval(timer)
        }
    }, [images, interval])

    return (
        <div class={`flex items-center justify-center h-full ${construction ? 'max-w-[520px] w-full' : 'relative'}`}>
            {phoneImage &&
                <div class="relative z-10">
                    <img src={phoneImage} alt="phone" />
                </div>
            }
            <div class={`z-[1] overflow-hidden h-full w-full ${construction ? '' : 'absolute max-w-96 py-3 px-4'}`}>
                <div class={`relative ${construction ? 'min-h-[52vh] flex items-center justify-center mx-auto max-md:max-w-[60%]' : ''}`}>
                    {images.map((img, i) => (
                        <img
                            key={i}
                            src={img.image}
                            alt={`Slide ${i}`}
                            class={`absolute ${construction ? '' : 'top-0 left-0'} w-full object-cover block max-w-[490px]`}
                            style={{
                                transition: `opacity ${transitionDuration}ms ease-in-out`,
                                opacity: i === currentIndex ? 1 : 0,
                            }}
                        />
                    ))}
                </div>
            </div>
            <div class={`hidden md:block absolute ${construction ? 'left-0' : 'left-[-45%]'} lg: bottom-0 w-[10vw] z-0`}>
                <svg width="100%" viewBox="0 0 204 326" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M168.73 43.1723H109.44V50.8153H168.73V43.1723Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path d="M163.657 28.8452H109.44V36.4883H163.657V28.8452Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path d="M144.24 14.5182H109.44V22.1612H144.24V14.5182Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path d="M160.448 0.162048H109.44V7.80508H160.448V0.162048Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path d="M68 258L67.266 258.154L67.3911 258.75H68V258ZM180.718 199.087L179.983 198.939V198.939L180.718 199.087ZM181.323 180.608L180.716 181.049V181.049L181.323 180.608ZM161.5 176.5C161.086 176.5 160.75 176.836 160.75 177.25C160.75 177.664 161.086 178 161.5 178V176.5ZM51 176.5C50.5858 176.5 50.25 176.836 50.25 177.25C50.25 177.664 50.5858 178 51 178V176.5ZM68 178C68.4142 178 68.75 177.664 68.75 177.25C68.75 176.836 68.4142 176.5 68 176.5V178ZM94.0378 193.727C93.7491 193.43 93.2743 193.423 92.9773 193.712C92.6802 194.001 92.6735 194.476 92.9622 194.773L94.0378 193.727ZM136.538 194.773C136.827 194.476 136.82 194.001 136.523 193.712C136.226 193.423 135.751 193.43 135.462 193.727L136.538 194.773ZM115.5 147.5C115.5 147.086 115.164 146.75 114.75 146.75C114.336 146.75 114 147.086 114 147.5H115.5ZM45.7192 151.877L46.4532 151.723L46.4503 151.709L46.4468 151.695L45.7192 151.877ZM21.25 138.25C20.8358 138.25 20.5 138.586 20.5 139C20.5 139.414 20.8358 139.75 21.25 139.75V138.25ZM75.48 258.75C75.8942 258.75 76.23 258.414 76.23 258C76.23 257.586 75.8942 257.25 75.48 257.25V258.75ZM68 258.75H129.737V257.25H68V258.75ZM129.737 258.75C139.349 258.75 146.979 257.241 153.122 254.39C159.273 251.535 163.895 247.354 167.512 242.074C174.714 231.563 177.944 216.668 181.454 199.235L179.983 198.939C176.457 216.456 173.269 231.017 166.275 241.226C162.795 246.305 158.374 250.299 152.49 253.029C146.597 255.764 139.197 257.25 129.737 257.25V258.75ZM181.454 199.235C182.464 194.216 183.239 190.378 183.445 187.378C183.653 184.365 183.301 182.054 181.93 180.167L180.716 181.049C181.785 182.52 182.146 184.409 181.949 187.275C181.751 190.155 181.002 193.878 179.983 198.939L181.454 199.235ZM181.93 180.167C180.547 178.265 178.545 177.365 175.797 176.929C173.081 176.498 169.502 176.5 164.85 176.5V178C169.553 178 172.99 178.002 175.562 178.41C178.102 178.814 179.658 179.593 180.716 181.049L181.93 180.167ZM164.85 176.5H161.5V178H164.85V176.5ZM51 178H68V176.5H51V178ZM92.9622 194.773C93.9724 195.812 95.4225 197.64 97.156 199.847C98.8762 202.037 100.853 204.571 102.888 206.972C104.919 209.369 107.029 211.659 109.02 213.355C110.016 214.203 111 214.919 111.946 215.424C112.885 215.927 113.835 216.25 114.75 216.25V214.75C114.177 214.75 113.477 214.543 112.653 214.102C111.835 213.664 110.941 213.021 109.993 212.213C108.094 210.597 106.047 208.38 104.032 206.002C102.02 203.627 100.062 201.118 98.3357 198.92C96.6231 196.74 95.1164 194.837 94.0378 193.727L92.9622 194.773ZM135.462 193.727C134.384 194.837 132.877 196.74 131.164 198.92C129.438 201.118 127.48 203.627 125.468 206.002C123.453 208.38 121.406 210.597 119.507 212.213C118.559 213.021 117.665 213.664 116.847 214.102C116.022 214.543 115.323 214.75 114.75 214.75V216.25C115.665 216.25 116.615 215.927 117.554 215.424C118.5 214.919 119.484 214.203 120.48 213.355C122.471 211.659 124.581 209.369 126.612 206.972C128.647 204.571 130.624 202.037 132.344 199.847C134.077 197.64 135.528 195.812 136.538 194.773L135.462 193.727ZM115.5 215.5V147.5H114V215.5H115.5ZM68.734 257.846L46.4532 151.723L44.9852 152.031L67.266 258.154L68.734 257.846ZM46.4468 151.695C44.4714 143.793 37.3717 138.25 29.2268 138.25V139.75C36.6834 139.75 43.1831 144.825 44.9916 152.059L46.4468 151.695ZM29.2268 138.25H21.25V139.75H29.2268V138.25ZM75.48 257.25H71.9828V258.75H75.48V257.25ZM71.9828 257.25C59.9516 257.25 50.25 267.401 50.25 279.857H51.75C51.75 268.171 60.8371 258.75 71.9828 258.75V257.25ZM50.25 279.857C50.25 282.254 52.1229 284.25 54.4972 284.25V282.75C53.0085 282.75 51.75 281.484 51.75 279.857H50.25ZM54.4972 284.25H148.75V282.75H54.4972V284.25ZM101.25 296.25C101.25 302.877 95.8774 308.25 89.25 308.25V309.75C96.7058 309.75 102.75 303.706 102.75 296.25H101.25ZM89.25 308.25C82.6226 308.25 77.25 302.877 77.25 296.25H75.75C75.75 303.706 81.7942 309.75 89.25 309.75V308.25ZM77.25 296.25C77.25 289.623 82.6226 284.25 89.25 284.25V282.75C81.7942 282.75 75.75 288.794 75.75 296.25H77.25ZM89.25 284.25C95.8774 284.25 101.25 289.623 101.25 296.25H102.75C102.75 288.794 96.7058 282.75 89.25 282.75V284.25ZM160.75 296.25C160.75 302.877 155.377 308.25 148.75 308.25V309.75C156.206 309.75 162.25 303.706 162.25 296.25H160.75ZM148.75 308.25C142.123 308.25 136.75 302.877 136.75 296.25H135.25C135.25 303.706 141.294 309.75 148.75 309.75V308.25ZM136.75 296.25C136.75 289.623 142.123 284.25 148.75 284.25V282.75C141.294 282.75 135.25 288.794 135.25 296.25H136.75ZM148.75 284.25C155.377 284.25 160.75 289.623 160.75 296.25H162.25C162.25 288.794 156.206 282.75 148.75 282.75V284.25Z" fill="#76F5F7" />
                </svg>
            </div>
            <div class={`absolute hidden top-3 ${construction ? 'right-0 lg:block' : 'md:block right-[-60%]'}  w-[16vw] z-0`}>
                <svg width="100%" viewBox="0 0 422 355" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M228.09 294.139C227.46 294.139 226.942 293.471 226.942 292.657V13.8748C226.942 8.1498 223.338 3.50005 218.901 3.50005C218.901 3.50005 11.5979 3.50005 0 3.50005V0.535828H218.901C224.599 0.535828 229.239 6.52239 229.239 13.8748V292.657C229.239 293.471 228.721 294.139 228.09 294.139Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path opacity="0.5" d="M167.582 349.246C170.265 349.246 172.441 347.069 172.441 344.384C172.441 341.699 170.265 339.522 167.582 339.522C164.898 339.522 162.723 341.699 162.723 344.384C162.723 347.069 164.898 349.246 167.582 349.246Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path d="M147.676 344.384C147.676 347.077 145.507 349.246 142.817 349.246C140.126 349.246 137.958 347.077 137.958 344.384C137.958 341.692 140.126 339.522 142.817 339.522C145.507 339.522 147.676 341.692 147.676 344.384Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path opacity="0.5" d="M118.025 349.246C120.709 349.246 122.884 347.069 122.884 344.384C122.884 341.699 120.709 339.522 118.025 339.522C115.341 339.522 113.166 341.699 113.166 344.384C113.166 347.069 115.341 349.246 118.025 349.246Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path opacity="0.5" d="M98.0926 344.384C98.0926 347.077 95.9243 349.246 93.2335 349.246C90.5428 349.246 88.3745 347.077 88.3745 344.384C88.3745 341.692 90.5428 339.522 93.2335 339.522C95.9243 339.522 98.0926 341.692 98.0926 344.384Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path opacity="0.5" d="M73.3008 344.384C73.3008 347.077 71.1325 349.246 68.4418 349.246C65.751 349.246 63.5828 347.077 63.5828 344.384C63.5828 341.692 65.751 339.522 68.4418 339.522C71.1325 339.522 73.3008 341.692 73.3008 344.384Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path opacity="0.5" d="M48.5096 344.384C48.5096 347.077 46.3413 349.246 43.6505 349.246C40.9598 349.246 38.7915 347.077 38.7915 344.384C38.7915 341.692 40.9598 339.522 43.6505 339.522C46.3413 339.522 48.5096 341.692 48.5096 344.384Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path opacity="0.5" d="M18.859 349.246C21.5426 349.246 23.7181 347.069 23.7181 344.384C23.7181 341.699 21.5426 339.522 18.859 339.522C16.1755 339.522 14 341.699 14 344.384C14 347.069 16.1755 349.246 18.859 349.246Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path d="M223.721 351.469L214.003 339.757C215.492 337.98 216.432 335.81 216.667 333.457C216.955 330.425 216.04 327.471 214.081 325.118C210.084 320.282 202.874 319.602 198.041 323.628C193.208 327.654 192.529 334.843 196.552 339.679C199.504 343.234 204.154 344.541 208.334 343.391C209.222 343.156 210.084 342.763 210.92 342.293L220.638 354.03C221.161 354.658 221.971 354.893 222.702 354.684C222.963 354.606 223.225 354.475 223.46 354.292C224.322 353.586 224.426 352.331 223.721 351.469ZM199.609 337.117C196.996 333.98 197.44 329.301 200.575 326.686C201.411 325.981 202.352 325.51 203.344 325.249C206.061 324.517 209.092 325.353 210.999 327.654C212.253 329.17 212.853 331.104 212.671 333.065C212.488 335.026 211.547 336.803 210.032 338.084C206.897 340.698 202.221 340.254 199.609 337.117Z" fill="#D9D9D9" fill-opacity="0.5" />
                    <path d="M393.125 253.5C393.125 264.891 383.891 274.125 372.5 274.125C361.109 274.125 351.875 264.891 351.875 253.5C351.875 242.109 361.109 232.875 372.5 232.875" stroke="#76F5F7" stroke-width="1.5" stroke-linecap="round" />
                    <path d="M380.75 213.075C378.084 212.534 375.325 212.25 372.5 212.25C349.718 212.25 331.25 230.718 331.25 253.5C331.25 276.282 349.718 294.75 372.5 294.75C395.282 294.75 413.75 276.282 413.75 253.5C413.75 250.675 413.466 247.916 412.925 245.25" stroke="#76F5F7" stroke-width="1.5" stroke-linecap="round" />
                    <path d="M372.625 253.345L391.406 234.564M404.429 221.921L402.147 213.724C401.727 212.374 400.102 211.836 399.007 212.731C393.083 217.571 386.63 224.092 391.9 234.377C402.518 239.328 408.58 232.651 413.227 227.039C414.152 225.922 413.595 224.244 412.202 223.841L404.429 221.921Z" stroke="#76F5F7" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </div>
        </div>
    )
}

export default PhoneSlider
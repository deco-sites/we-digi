import Modal from 'site/components/ui/Modal.tsx'
import { Props } from 'site/sections/ModalContact.tsx'
import { useSignal } from "@preact/signals";
import { useEffect } from "preact/hooks";

const ModalContactIsland = ({ link, bg, text }: Props) => {
    const modalAlreadyOpen = useSignal(false)

    const handleCloseModal = () => {
        sessionStorage.setItem('modalContact', 'true')
        modalAlreadyOpen.value = false
    }

    useEffect(() => {
        const modal = sessionStorage.getItem('modalContact')

        if(!modal) modalAlreadyOpen.value = true
    }, [])
    

    return (
        <Modal
            loading="lazy"
            open={modalAlreadyOpen.value}
            onClose={handleCloseModal}
            class=""
        >
            <div style={{ backgroundImage: `url(${bg})` }} class="w-full lg:max-w-[850px] max-w-[350px] z-10 bg-center bg-no-repeat bg-cover">
                <div class="flex justify-end lg:mb-8 mb-3">
                    <button
                        class=""
                        onClick={handleCloseModal}
                    >
                        <svg width="42" height="42" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M27 15L15 27" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M15 15L27 27" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                </div>
                <div class="w-full lg:max-w-[80%] mx-auto flex flex-col lg:gap-16 gap-8 lg:mb-14 mb-8 px-4">
                    <div class="flex items-center justify-center">
                        <svg class="lg:max-w-[292px] max-w-[120px]" width="100%" height="100%" viewBox="0 0 292 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_44_420)">
                                <path d="M23.5509 59.8862C20.9328 59.8651 18.3883 59.032 16.2798 57.5057C14.1713 55.9793 12.6062 53.8374 11.8076 51.3852L0 18.0139H9.1451L19.988 48.6401C20.2054 49.4155 20.6676 50.1028 21.308 50.603C21.9484 51.1033 22.7338 51.3904 23.5509 51.4232C24.382 51.3876 25.1791 51.0888 25.8235 50.5713C26.4679 50.0538 26.925 49.3454 27.1266 48.5516L37.3007 17.9633H46.4201L35.3842 51.1449C34.6279 53.6368 33.0846 55.8273 30.9779 57.3989C28.8712 58.9705 26.3104 59.8417 23.6666 59.8862H23.5509Z" fill="white" />
                                <path d="M49.0312 59.8862C46.4154 59.8624 43.8738 59.0282 41.7678 57.502C39.6618 55.9758 38.0987 53.8354 37.3008 51.3852L36.2847 48.4883L40.7093 35.1297L45.4812 48.5895C45.6986 49.3649 46.1608 50.0522 46.8012 50.5525C47.4416 51.0527 48.227 51.3399 49.0441 51.3726C49.8752 51.337 50.6723 51.0382 51.3167 50.5207C51.9611 50.0032 52.4182 49.2948 52.6198 48.501L62.7553 17.9254H71.8618L60.8645 51.1449C60.1083 53.6368 58.565 55.8273 56.4583 57.3989C54.3515 58.9705 51.7908 59.8417 49.147 59.8862H49.0312Z" fill="white" />
                                <path d="M90.3061 42.7198C91.2837 42.7198 92.3255 42.7198 93.4446 42.7198H95.4382C98.7563 42.7069 102.066 42.4021 105.329 41.809C107.945 41.3743 110.465 40.4969 112.777 39.2157C114.446 38.2824 115.79 36.8761 116.635 35.1803C117.807 32.6751 118.093 29.857 117.45 27.1732C116.807 24.4894 115.271 22.0939 113.085 20.3669C111.399 19.0521 109.486 18.0452 107.439 17.3941C101.956 15.7833 96.0898 15.9608 90.7177 17.9001C88.0339 18.9166 85.5846 20.4523 83.5149 22.4162C81.4531 24.4063 79.8289 26.7916 78.7429 29.4244C77.9307 31.3653 77.4023 33.4097 77.1737 35.4965C73.6297 35.1679 70.1052 34.6612 66.6138 33.9785L64.5815 40.0886C68.7396 40.9461 72.9437 41.5712 77.1737 41.9608C77.4049 43.8918 77.9071 45.782 78.6658 47.5775C79.7657 50.1379 81.4104 52.437 83.4891 54.3201C85.542 56.1761 87.964 57.5932 90.602 58.482C93.415 59.4361 96.3729 59.9109 99.3483 59.8862C101.419 59.9232 103.49 59.7793 105.535 59.4561C107.206 59.1318 108.855 58.7094 110.474 58.191C111.702 57.8272 112.894 57.3573 114.037 56.7869C114.976 56.2935 115.683 55.914 116.121 55.6357L112.609 49.0449L111.066 49.7913C110.228 50.1676 109.369 50.497 108.493 50.778C107.415 51.1355 106.31 51.4104 105.188 51.6003C103.863 51.8261 102.52 51.9361 101.175 51.9292C96.8874 51.9292 93.5817 51.0647 91.258 49.3359C90.1451 48.5349 89.2057 47.5239 88.4946 46.3619C87.7835 45.1999 87.3149 43.9101 87.1163 42.568L89.0456 42.6313L90.3061 42.7198ZM87.7337 31.4864C88.29 29.9846 89.1277 28.5987 90.2032 27.4004C91.2973 26.1934 92.6386 25.2277 94.1391 24.5668C95.8515 23.8232 97.7083 23.4563 99.5799 23.4915C101.793 23.4196 103.982 23.9633 105.895 25.0601C106.717 25.5391 107.39 26.2289 107.843 27.0557C108.297 27.8825 108.512 28.8151 108.468 29.7533C108.468 30.5756 108.297 31.3892 107.966 32.1442C107.492 33.0223 106.743 33.7273 105.831 34.1556C104.44 34.874 102.942 35.3734 101.393 35.6357C98.9368 36.072 96.4421 36.267 93.9462 36.2176H91.3223C90.036 36.2176 88.4797 36.2176 86.7433 36.1038C86.8135 34.524 87.1392 32.9654 87.708 31.4864H87.7337Z" fill="white" />
                                <path d="M207.7 2.49489e-05C208.384 -0.0135037 209.063 0.110848 209.696 0.365407C210.328 0.619967 210.901 0.999334 211.379 1.4801C211.861 1.94627 212.242 2.504 212.499 3.11942C212.755 3.73483 212.882 4.39509 212.871 5.06011C212.885 5.72936 212.761 6.39444 212.504 7.01445C212.247 7.63447 211.865 8.19631 211.379 8.66543C210.4 9.61337 209.081 10.1447 207.707 10.1447C206.333 10.1447 205.014 9.61337 204.035 8.66543C203.545 8.19876 203.159 7.63766 202.9 7.01727C202.641 6.39688 202.515 5.73058 202.53 5.06011C202.515 4.38965 202.641 3.72335 202.9 3.10296C203.159 2.48257 203.545 1.92147 204.035 1.4548C204.513 0.979566 205.084 0.605394 205.715 0.355235C206.345 0.105075 207.021 -0.0157996 207.7 2.49489e-05Z" fill="white" />
                                <path d="M203.649 17.938H195.353V24.9083H203.649V58.9121H211.765V17.938H203.649Z" fill="white" />
                                <path d="M163.12 59.8862C151.608 59.8862 142.257 50.0949 142.257 38.0645C142.257 26.0342 151.608 16.2556 163.12 16.2556C174.631 16.2556 183.931 26.0342 183.931 38.0645C183.931 50.0949 174.631 59.8862 163.12 59.8862ZM164.123 24.2252C161.327 24.1623 158.576 24.9203 156.22 26.4022C153.864 27.8842 152.01 30.023 150.896 32.5456C149.781 35.0683 149.456 37.8603 149.962 40.5654C150.468 43.2704 151.783 45.7658 153.737 47.7331C155.692 49.7003 158.198 51.0501 160.936 51.6102C163.674 52.1704 166.519 51.9154 169.109 50.8779C171.699 49.8403 173.916 48.0673 175.477 45.7851C177.038 43.5029 177.872 40.815 177.873 38.0645C177.907 34.4384 176.48 30.9466 173.903 28.353C171.326 25.7594 167.81 24.2752 164.123 24.2252Z" fill="white" />
                                <path d="M185.989 2.28882e-05H177.873V58.9121H185.989V2.28882e-05Z" fill="white" />
                                <path d="M243.02 59.8862C231.586 59.8862 222.286 50.0949 222.286 38.0645C222.286 26.0342 231.586 16.2556 243.02 16.2556C254.455 16.2556 263.754 26.0342 263.754 38.0645C263.754 50.0949 254.455 59.8862 243.02 59.8862ZM244.152 24.2252C241.356 24.1623 238.605 24.9203 236.249 26.4022C233.893 27.8842 232.04 30.023 230.925 32.5456C229.811 35.0683 229.486 37.8603 229.992 40.5654C230.498 43.2704 231.812 45.7658 233.766 47.7331C235.721 49.7003 238.227 51.0501 240.965 51.6102C243.703 52.1704 246.549 51.9154 249.139 50.8779C251.729 49.8403 253.946 48.0673 255.506 45.7851C257.067 43.5029 257.901 40.815 257.902 38.0645C257.94 34.4375 256.514 30.9437 253.936 28.3494C251.358 25.755 247.84 24.2719 244.152 24.2252Z" fill="white" />
                                <path d="M257.889 58.8994C257.741 62.3996 256.234 65.7108 253.679 68.1512C251.124 70.5916 247.714 71.9754 244.152 72.0177C241.662 72.006 239.222 71.3274 237.094 70.0548C234.966 68.7822 233.231 66.9637 232.075 64.7944L225.45 69.4244C227.366 72.6321 230.098 75.294 233.377 77.1483C236.656 79.0026 240.37 79.9854 244.152 80C249.864 79.9595 255.336 77.7393 259.415 73.8076C263.494 69.8759 265.862 64.5399 266.018 58.9247L257.889 58.8994Z" fill="white" />
                                <path d="M266.018 17.938H257.902V58.9248H266.018V17.938Z" fill="white" />
                                <path d="M286.829 2.04013e-05C287.511 -0.0147887 288.189 0.109028 288.819 0.363714C289.45 0.618399 290.021 0.998464 290.495 1.4801C290.977 1.946 291.357 2.50396 291.611 3.11965C291.866 3.73533 291.989 4.3957 291.974 5.06011C291.989 5.73058 291.863 6.39688 291.604 7.01726C291.346 7.63765 290.959 8.19876 290.469 8.66542C289.492 9.61257 288.176 10.1435 286.804 10.1435C285.432 10.1435 284.115 9.61257 283.138 8.66542C282.657 8.19442 282.281 7.63137 282.031 7.01119C281.78 6.39101 281.663 5.72692 281.684 5.06011C281.669 4.38964 281.795 3.72334 282.054 3.10295C282.313 2.48257 282.7 1.92146 283.189 1.4548C283.663 0.980886 284.23 0.60734 284.856 0.357152C285.482 0.106964 286.154 -0.0145738 286.829 2.04013e-05Z" fill="white" />
                                <path d="M282.778 17.938H274.469V24.9083H282.778V58.9121H290.881V17.938H282.778Z" fill="white" />
                                <path d="M130.282 49.2094C131.414 49.2044 132.522 49.5302 133.465 50.1454C134.408 50.7607 135.144 51.6376 135.579 52.6649C136.015 53.6923 136.13 54.8237 135.91 55.9156C135.691 57.0075 135.146 58.0106 134.346 58.7976C133.546 59.5847 132.526 60.1201 131.416 60.336C130.306 60.5519 129.155 60.4386 128.111 60.0103C127.066 59.5821 126.174 58.8583 125.549 57.9307C124.923 57.0032 124.592 55.9138 124.597 54.8008C124.588 54.0642 124.73 53.3333 125.012 52.6511C125.295 51.9688 125.713 51.3491 126.243 50.8282C126.773 50.3073 127.403 49.8957 128.096 49.6177C128.79 49.3397 129.533 49.2009 130.282 49.2094Z" fill="#76F5F7" />
                            </g>
                            <defs>
                                <clipPath id="clip0_44_420">
                                    <rect width="292" height="80" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                    </div>
                    <div class="lg:[&_p]:text-6xl [&_p]:text-2xl text-center" dangerouslySetInnerHTML={{ __html: text }} />
                    {link &&
                        <a class="mx-auto block lg:text-xl text-center text-base w-fit max-w-[550px] px-8 py-3 rounded-xl text-black font-bold hover:!brightness-75 transition-all duration-300 ease-in-out" style={{ backgroundColor: link.bgColor ?? '#BFF776' }} href={link.url}>{link.label}</a>
                    }
                </div>
            </div>
        </Modal>
    )
}

export default ModalContactIsland